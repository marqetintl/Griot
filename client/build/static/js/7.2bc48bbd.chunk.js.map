{"version":3,"sources":["../../../../../packages/miq-dmsjs/src/docufile/utils.jsx","../../../../../packages/miq-dmsjs/src/docufile/UploadButton.jsx","../../../../../packages/miq-dmsjs/src/docufile/components.jsx","../../../../../packages/miq-dmsjs/src/docufile/FileList.jsx","../../../../../packages/miq-dmsjs/src/document/UpdateView/UpdateForm.jsx","../../../../../packages/miq-dmsjs/src/document/UpdateView/index.jsx","../../../../../packages/miq-dmsjs/src/components.jsx"],"names":["docufileServices","file","isRequired","name","length","Promise","reject","files","fd","FormData","append","services","post","headers","docFileSlug","docSlug","delete","SuccesMessage","name_truncated","className","DocuFileUploadButton","onSuccess","props","toast","useContext","ToastCtx","uploadRef","createRef","Icon","Icons","PaperClip","label","title","onClick","click","onChange","evt","Array","from","target","forEach","then","data","success","component","catch","err","error","message","ref","FileDeleteIconButton","document","is_read_only","handleDelete","slug","onFileDelete","disabled","Trash","render","renderHeader","title_truncated","renderFooter","setOpen","getIcon","ext","getFileIcon","DocuFileList","items","isArray","style","overflowX","renderItem","Tr","Td","href","getImgUrl","src","size","align","DocumentUpdateForm","form","handleTextInputSave","value","Label","TextInput","onSave","autoComplete","placeholder","TextAreaX","Actions","path","match","successUrl","addForwardSlash","url","history","push","replace","location","reload","DocumentUpdateView","params","useState","setDocument","setError","useForm","reference","description","setValues","useEffect","docServices","detail","response","status","to","patch","shared","context","actions","Share","Section","patchFile","action","files_data","filter","i","BackToStaffDocumentsLink","docUrls","staff_path","ArrowLeft"],"mappings":"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","file":"static/js/7.2bc48bbd.chunk.js","sourcesContent":["import { services } from \"@miq/adminjs\";\n\nexport const docufileServices = {\n    postFile(file = isRequired(\"file\")) {\n        let name = file.name;\n        if (name.length >= 300) {\n            return Promise.reject({ files: \"File name is too long\" });\n        }\n\n        const fd = new FormData();\n        fd.append(\"src\", file, name);\n\n        return services.post(`docufiles/`, fd, {\n            headers: { \"content-type\": \"multipart/form-data\" },\n        });\n    },\n\n    delete(docFileSlug, docSlug) {\n        return services.delete(`docufiles/${docFileSlug}/?document=${docSlug}`);\n    },\n};\n","import { createRef, useContext } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport { FileInput, IconButton, Icons, ToastCtx } from \"@miq/components\";\n\nimport { docufileServices } from \"./utils\";\n\nconst propTypes = {\n    onSuccess: PropTypes.func,\n};\n\nconst SuccesMessage = ({ name_truncated }) => (\n    <div>\n        <span className=\"fw-bold d-block\">File Added</span>\n        {name_truncated}\n    </div>\n);\n\nexport default function DocuFileUploadButton({ onSuccess, ...props }) {\n    const toast = useContext(ToastCtx);\n    let uploadRef = createRef();\n\n    function uploadFiles(evt) {\n        // TODO: Ensure this filename has at most 100 characters\n\n        Array.from(evt.target.files).forEach((file) => {\n            docufileServices\n                .postFile(file)\n                .then((data) => {\n                    if (onSuccess) onSuccess(data);\n                    if (toast)\n                        toast.success({\n                            component: <SuccesMessage {...data} />,\n                        });\n                })\n                .catch((err) => {\n                    // console.log(err);\n                    if (toast) toast.error({ message: \"File upload failed.\\nPlease try again.\" });\n                });\n        });\n    }\n\n    return (\n        <>\n            <IconButton\n                Icon={Icons.PaperClip}\n                label=\"Joindre\"\n                title=\"Joindre des fichiers Ã  ce document\"\n                {...props}\n                onClick={() => uploadRef.click()}\n            />\n            <FileInput onChange={uploadFiles} ref={(file) => (uploadRef = file)} />\n        </>\n    );\n}\n\nDocuFileUploadButton.propTypes = propTypes;\n","import { useContext } from \"react\";\nimport { Icons, ConfirmIconButton, Button, ToastCtx } from \"@miq/components\";\n\nimport { docufileServices } from \"./utils\";\n\nexport const FileDeleteIconButton = ({ document, file, ...props }) => {\n    const toast = useContext(ToastCtx);\n\n    if (!document || document.is_read_only) return null;\n\n    const handleDelete = () =>\n        docufileServices\n            .delete(file.slug, document.slug)\n            .then((data) => {\n                props.onFileDelete({ ...data, slug: file.slug });\n                toast.success({ message: \"File deleted.\" });\n            })\n            .catch((err) => {\n                // console.log(err);\n                toast.error({ message: \"Something went wrong.\" });\n            });\n\n    return (\n        <ConfirmIconButton\n            disabled={document.is_read_only}\n            Icon={Icons.Trash}\n            render={() => {\n                return <div className=\"p-3\">Are you sure?</div>;\n            }}\n            renderHeader={() => <div className=\"flex-1 fw-bold\">Delete file {`${document.title_truncated}`}</div>}\n            renderFooter={({ setOpen }) => {\n                return (\n                    <div className=\"flex-1\">\n                        <Button onClick={() => setOpen(false)} className=\"me-1\">\n                            Annuler\n                        </Button>\n                        <Button className=\"btn-danger\" onClick={handleDelete}>\n                            Delete\n                        </Button>\n                    </div>\n                );\n            }}\n        />\n    );\n};\n","import { Icons, Button, ImgSquare, Img, ConfirmIconButton } from '@miq/components';\nimport { Table, ItemTable, IconButton } from '@miq/components';\nimport { getImgUrl } from '@miq/utils';\n\nimport './docufile-grid.scss';\nimport { FileDeleteIconButton } from './components';\nimport { isArray } from 'lodash';\n\nconst getIcon = (file) => {\n  switch (file.ext) {\n    case '.jpg':\n    case '.jpeg':\n    case '.png':\n      return <ImgSquare {...file} />;\n\n    default:\n      const Icon = Icons.getFileIcon(file.ext);\n      return <Icon className=\"icon mb-1\" />;\n  }\n};\n\nexport function DocuFileList({ items, ...props }) {\n  if (!isArray(items)) return null;\n\n  if (!items.length > 0)\n    return <div className=\"w-100 text-center py-4 bg-gray-100 rounded\">Ce document n'a pas de fichiers ajoutÃ©s.</div>;\n\n  return (\n    <div className=\"docufile-list border-1 rounded mb-3\" style={{ overflowX: 'scroll' }}>\n      <ItemTable\n        items={items}\n        renderItem={(file) => {\n          return (\n            <Table.Tr className=\"docufile-list-item border-bottom\" key={file.slug}>\n              <Table.Td>\n                <a href={getImgUrl(file.src)} className=\"docufile-btn\" target=\"_blank\">\n                  <div className=\"d-flex\">\n                    <span className=\"docufile-icon-wrapper d-none d-md-block me-1\">{getIcon(file)}</span>\n                    <div className=\"\">\n                      <div>{file.name_truncated}</div>\n                      <span className=\"text-sm text-muted\">{file.size}</span>\n                    </div>\n                  </div>\n                </a>\n              </Table.Td>\n\n              <Table.Td align=\"right\">\n                <div className=\"actions\">\n                  <FileDeleteIconButton {...props} {...{ file }} />\n                </div>\n              </Table.Td>\n            </Table.Tr>\n          );\n        }}\n        className=\"w-100\"\n      />\n    </div>\n  );\n}\n","import Form, { FormProvider } from '@miq/form';\n\nimport { isRequired } from '@miq/utils';\n\nexport default function DocumentUpdateForm({ docSlug, ...props }) {\n  const { form = isRequired('form'), document, handleTextInputSave } = props;\n\n  return (\n    <FormProvider value={form}>\n      <div className=\"document-field d-grid grid-lg-12 mb-2\">\n        <Form.Label value=\"Reference\" className=\"span-12 mb-1\" />\n        <Form.TextInput\n          name=\"reference\"\n          onSave={handleTextInputSave}\n          autoComplete=\"off\"\n          className=\"span-12 span-md-4\"\n          placeholder=\"Ajouter une reference ...\"\n          disabled={document.is_read_only}\n        />\n      </div>\n\n      <div className=\"document-field d-grid grid-1 grid-xl-12 mb-2\">\n        <Form.Label value=\"Description\" className=\"span-12 mb-1\" />\n\n        <div className=\"span-lg-8\">\n          <Form.TextAreaX\n            name=\"description\"\n            onSave={handleTextInputSave}\n            placeholder=\"Ajouter une description ...\"\n            disabled={document.is_read_only}\n          />\n        </div>\n      </div>\n    </FormProvider>\n  );\n}\n","import { useContext, useEffect, useState } from 'react';\nimport { Redirect } from 'react-router-dom';\n\nimport Form, { useForm } from '@miq/form';\nimport { AdminView } from '@miq/adminjs';\nimport { addForwardSlash } from '@miq/utils';\nimport { Icons, IconNavLink, ToastCtx } from '@miq/components';\n\nimport './update-view.scss';\n\nimport { BackToStaffDocumentsLink } from '../../components';\nimport DocuFileUploadButton from '../../docufile/UploadButton';\nimport { DocuFileList } from '../../docufile';\nimport { docServices } from '../utils';\nimport {\n  DocumentTitleInput,\n  DocumentArchiveIconButton,\n  DocumentApproveIconButton,\n  DocumentDeleteIconButton,\n} from '../components';\n// import DocumentShareModal from './ShareModal';\nimport DocumentUpdateForm from './UpdateForm';\n\nconst Actions = (props) => {\n  const { docSlug, document } = props;\n\n  const { path } = props.match;\n  const successUrl = `${addForwardSlash(props.match.url)}view/`;\n\n  return (\n    <div className=\"document-update-view-actions d-flex align-items-center justify-content-between mb-1\">\n      <div>\n        <DocumentDeleteIconButton\n          {...props}\n          {...{ docSlug }}\n          label=\"Supprimer\"\n          className=\"btn-danger-3 me-1\"\n          onSuccess={() => props.history.push(path.replace(':docSlug/', ''))}\n        />\n      </div>\n\n      <div className=\"d-flex\">\n        <DocumentApproveIconButton\n          {...props}\n          document={document}\n          onSuccess={() => location.reload()}\n          className=\"btn-primary-2 me-2\"\n        />\n        <DocumentArchiveIconButton\n          {...props}\n          document={document}\n          onSuccess={() => props.history.push(successUrl)}\n          className=\"btn-primary-3\"\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default function DocumentUpdateView(props) {\n  const { docSlug } = props.match.params;\n\n  const [document, setDocument] = useState(null);\n  const [error, setError] = useState(null);\n  const toast = useContext(ToastCtx);\n\n  const form = useForm({ title: '', reference: '', description: '' });\n  const { setValues } = form;\n\n  useEffect(() => {\n    docServices\n      .detail(docSlug)\n      .then((data) => {\n        setDocument(data);\n        if (data.is_read_only) return;\n\n        setValues({\n          title: data.title || '',\n          reference: data.reference || '',\n          description: data.description || '',\n        });\n      })\n      .catch((err) => {\n        if (err.response) {\n          if (err.response.status === 404) {\n            setError('notfound');\n            return;\n          }\n        }\n\n        setError('error');\n      });\n  }, [docSlug, setValues]);\n\n  if (error) {\n    return (\n      <div>\n        <h1>Ce document n'existe pas</h1>\n      </div>\n    );\n  }\n\n  if (!document || !document.slug) return null;\n  if (document.is_read_only) return <Redirect to={`${addForwardSlash(props.match.url)}view/`} />;\n\n  const handleTextInputSave = ({ name, value }) => {\n    if (!document || document.is_read_only) return;\n    return docServices.patch(docSlug, { [name]: value }, { [name]: document[name] }).catch((err) => {});\n  };\n\n  const addFile = ({ slug }) =>\n    docServices\n      .patchFile(docSlug, { action: 'add', files: [slug] })\n      .then((data) => {\n        setDocument({ ...document, ...data });\n      })\n      .catch((err) => {});\n\n  const removeFile = ({ slug }) =>\n    setDocument({\n      ...document,\n      files: document.files.filter((i) => i !== slug),\n      files_data: document.files_data.filter((i) => i.slug !== slug),\n    });\n\n  const shared = { ...props, toast, docSlug, document, setDocument, docSlug, form, handleTextInputSave };\n\n  return (\n    <Form context={form} className=\"document-update-form\">\n      {/* <Prompt when={isL} message=\"Are you sure?\"> */}\n      <AdminView\n        className=\"document-update-view miq-container-fluid\"\n        title={<BackToStaffDocumentsLink className=\"btn-secondary-4\" />}\n        actions={\n          <IconNavLink\n            to={`${addForwardSlash(props.match.url)}share/`}\n            // onClick={() => setOpen(true)}\n            disabled={document.is_read_only}\n            Icon={Icons.Share}\n            className=\"btn-primary\"\n            label=\"Partager\"\n            title=\"Partager ce document avec des personnes\"\n          />\n        }\n      >\n        <Actions {...shared} />\n\n        <AdminView.Section>\n          <DocumentTitleInput onSave={handleTextInputSave} />\n        </AdminView.Section>\n\n        {/* FORM */}\n        <AdminView.Section className=\"mb-3\">\n          <DocumentUpdateForm {...shared} />\n        </AdminView.Section>\n\n        {/* FILES */}\n\n        <AdminView.Section\n          title=\"Fichiers\"\n          actions={\n            <DocuFileUploadButton onSuccess={addFile} disabled={document.is_read_only} className=\"btn-primary-2\" />\n          }\n        >\n          <DocuFileList document={document} items={document.files_data} onFileDelete={removeFile} />\n        </AdminView.Section>\n      </AdminView>\n      {/* </Prompt> */}\n    </Form>\n  );\n}\n","import React from 'react';\n\nimport { AdminNavLink } from '@miq/adminjs';\nimport { Icons } from '@miq/components';\n\nimport { docUrls } from './document/utils';\n\nexport const BackToStaffDocumentsLink = (props) => {\n  return (\n    <AdminNavLink\n      to={props.to || docUrls.staff_path}\n      Icon={Icons.ArrowLeft}\n      title=\"Retourner aux documents\"\n      className={props.className}\n    />\n  );\n};\n"],"sourceRoot":""}