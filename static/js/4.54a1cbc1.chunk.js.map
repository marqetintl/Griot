{"version":3,"sources":["../../../../../packages/miq-shared/src/editor/src/Section/TextSection/index.jsx","../../../../../packages/miq-shared/src/editor/src/Section/index.jsx","../../../../../packages/miq-shared/src/editor/src/Section/utils.jsx","../../../../../packages/miq-shared/src/editor/src/index.jsx","../../../../../packages/miq-admin/src/pages/PageUpdateView/index.jsx","../../../../../packages/miq-shared/src/editor/src/Section/section-components.jsx","../../../../../packages/miq-shared/src/editor/src/Section/section-ui.jsx","../../../../../packages/miq-admin/src/pages/utils.jsx"],"names":["TxtSectionEdit","props","className","TxtSectionPreview","context","isEdit","TextSection","forwardRef","ref","id","getClassName","Icon","Icons","TextareaT","label","IS_DEV","displayName","SectionCtx","createContext","Section","data","isRequired","slug","type","useRef","useState","setEdit","ctx","useMemo","Component","lazy","getSectionComponent","fallback","Provider","value","sectionService","path","list","request","params","console","log","getService","this","get","sectSlug","actions","post","values","patch","oldValues","delete","sectionsReducer","state","results","action","payload","addOrUpdateArrayObject","filter","Editor","sourceSlug","children","EditorSections","useReducer","sections","dispatch","useEffect","source","then","map","PageUpdateView","pageSlug","match","page","setPage","pagesServices","catch","err","API","SectionSaveButton","form","ArrowUpCircle","title","onClick","e","shouldSave","text","onSave","SectionDeleteButton","Trash","remove","SectionEditButton","Eye","PencilSquare","SectionBody","SectionHeader","SectionFooter"],"mappings":"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","file":"static/js/4.54a1cbc1.chunk.js","sourcesContent":["import { getClassName, IS_DEV } from \"@miq/utils\";\nimport { forwardRef } from \"react\";\nimport { Icons } from \"@miq/components\";\nimport { SectionDeleteButton, SectionEditButton } from \"../section-components\";\nimport { SectionBody, SectionFooter, SectionHeader } from \"../section-ui\";\n\nimport \"./txt-section.scss\";\n\n/**\n * TEXT SECTION\n */\n\nconst TxtSectionEdit = (props) => {\n    return <div className=\"\">TxtSectionEdit</div>;\n};\n\nconst TxtSectionPreview = (props) => {\n    if (props.context.isEdit) return <TxtSectionEdit {...props} />;\n\n    return <div className=\"\">Prev</div>;\n};\n\nconst TextSection = forwardRef((props, ref) => {\n    return (\n        <div id={props.id} {...{ ref }} className={getClassName([props.className])}>\n            <SectionHeader Icon={Icons.TextareaT} />\n\n            <SectionBody>\n                <TxtSectionPreview {...props} />\n            </SectionBody>\n\n            <SectionFooter>\n                <div className=\"actions\">\n                    <SectionDeleteButton {...props} label=\"Delete\" />\n\n                    <SectionEditButton context={props.context} />\n                </div>\n            </SectionFooter>\n        </div>\n    );\n});\n\nif (IS_DEV) {\n    TextSection.displayName = \"TextSection\";\n}\n\nexport default TextSection;\n","import { createContext, lazy, Suspense, useMemo, useRef, useState } from \"react\";\n\nimport { getClassName, isRequired } from \"@miq/utils\";\nimport TextSection from \"./TextSection\";\n\nimport \"./section.scss\";\n\n// const MarkdownSection = lazy(()=>import('./MarkdownSection'))\n// const ImageSection = lazy(() => import(\"./ImageSection\"));\n\nconst getSectionComponent = (type) => {\n    switch (type) {\n        case \"MD\":\n            return lazy(() => import(\"./MarkdownSection\"));\n        // return MarkdownSection;\n        case \"IMG\":\n            return lazy(() => import(\"./ImageSection\"));\n        // return ImageSection;\n\n        default:\n            return TextSection;\n    }\n};\n\nconst SectionCtx = createContext();\n\nexport default function Section(props) {\n    const { data = isRequired(\"section data props\") } = props;\n    const { slug, type } = data;\n\n    const ref = useRef();\n    const [isEdit, setEdit] = useState(props.isEdit || false);\n\n    const ctx = useMemo(() => {\n        return {\n            isEdit,\n            setEdit,\n            // update: sectionActions.patch, remove: sectionActions.delete, dispatch\n        };\n    }, [isEdit]);\n\n    if (!slug) return null;\n\n    const Component = getSectionComponent(type);\n\n    return (\n        <Suspense fallback={<div>Loading ...</div>}>\n            <SectionCtx.Provider value={ctx}>\n                <Component\n                    {...props}\n                    context={ctx}\n                    ref={ref}\n                    className={getClassName([\"section\", isEdit && \"active\"])}\n                />\n            </SectionCtx.Provider>\n        </Suspense>\n    );\n}\n","import { getService } from \"@miq/utils\";\n\nexport const sectionService = {\n    path: `sections/`,\n    list(request, params) {\n        console.log(params);\n        return getService(request, this.path, params, \"SET_SECTIONS\");\n    },\n    get(sectSlug, params, type = \"PREPEND_SECTION\") {\n        return actions.get(`${this.path}${sectSlug}/`, params, type);\n    },\n    post(values, type = \"PREPEND_SECTION\") {\n        return actions.post(`${path}`, values, type);\n    },\n    patch(sectSlug, values, oldValues) {\n        return actions.patch(`${path}${sectSlug}/`, values, oldValues, \"UPDATE_SECTION\");\n    },\n    delete(sectSlug) {\n        return actions.delete(`${path}${sectSlug}/`, sectSlug, \"REMOVE_SECTION\");\n    },\n};\n\nexport const sectionsReducer = (state = { results: [] }, action) => {\n    const { type, payload = {} } = action;\n    let { results } = payload;\n\n    switch (type) {\n        case \"SET_SECTIONS\":\n            return { ...payload };\n\n        case \"APPEND_SECTION\":\n            results = addOrUpdateArrayObject(state.results, payload, \"slug\", true);\n            return { ...state, results };\n\n        case \"PREPEND_SECTION\":\n            results = addOrUpdateArrayObject(state.results, payload);\n            return { ...state, results };\n\n        case \"UPDATE_SECTION\":\n            results = addOrUpdateArrayObject(state.results, payload);\n            return { ...state, results };\n\n        case \"REMOVE_SECTION\":\n            results = state.results.filter(({ slug }) => slug !== payload.slug);\n            return { ...state, results };\n\n        default:\n            return { ...state };\n    }\n};\n","import React, { useEffect, useReducer } from \"react\";\n\nimport { isRequired } from \"@miq/utils\";\nimport \"./index.scss\";\n\nimport Section from \"./Section\";\nimport { sectionsReducer, sectionService } from \"./Section/utils\";\n\nexport default function Editor({ sourceSlug = isRequired(\"source slug\"), children, ...props }) {\n    return <div className=\"\">{children}</div>;\n}\n\nexport const EditorSections = ({\n    sourceSlug = isRequired(\"source slug\"),\n    request = isRequired(\"request\"),\n    ...props\n}) => {\n    const [sections, dispatch] = useReducer(sectionsReducer, { results: [] });\n\n    useEffect(() => {\n        if (!sourceSlug) return;\n\n        sectionService.list(request, { source: sourceSlug }).then((data) => {\n            dispatch({ type: \"SET_SECTIONS\", payload: data });\n            // setLoading(0);\n        });\n    }, [sourceSlug, request]);\n\n    return (\n        <div className=\"editor-panel\">\n            <div className=\"editor-content\">\n                <div className=\"editor-label\">{/* <Form.TextAreaX name=\"label\" tabIndex={1} maxLength={250} /> */}</div>\n\n                <div className=\"editor-sections\">\n                    {sections.results.map((data) => (\n                        <Section data={data} key={data.slug} />\n                    ))}\n                </div>\n\n                <div className=\"editor-actions\">\n                    {/* <SectionAddButton sourceSlug={props.sourceSlug} type=\"TXT\" />\n                    <SectionAddButton sourceSlug={props.sourceSlug} type=\"MD\" />\n                    <SectionAddButton sourceSlug={props.sourceSlug} type=\"IMG\" /> */}\n                </div>\n            </div>\n        </div>\n    );\n};\n","import { useEffect, useState } from \"react\";\n\nimport EditorForm, { EditorSections } from \"@miq/editor\";\n\nimport { pagesServices } from \"../utils\";\nimport { API } from \"../../utils\";\n\nexport default function PageUpdateView(props) {\n    const { pageSlug } = props.match.params;\n\n    const [page, setPage] = useState({});\n\n    useEffect(() => {\n        if (!pageSlug) return;\n\n        pagesServices\n            .get(pageSlug)\n            .then((data) => setPage(data))\n            .catch((err) => {});\n    }, [pageSlug]);\n\n    if (!page || !page.slug) return null;\n\n    return (\n        <EditorForm sourceSlug={page.slug} className=\"\">\n            <div className=\"\">\n                {page.slug}\n\n                <EditorSections sourceSlug={page.slug} request={API} />\n            </div>\n        </EditorForm>\n    );\n}\n","import { IconButton, Icons } from \"@miq/components\";\nimport { isRequired } from \"@miq/utils\";\n// import { pagesActions } from \"../../pages/utils\";\n\nexport const SectionAddButton = (props) => {\n    const { sourceSlug = isRequired(\"section source slug\"), type = isRequired(\"section type\") } = props;\n\n    const handleCreate = () => {\n        // pagesActions.postSection(sourceSlug, { type });\n    };\n\n    return <button onClick={handleCreate}>Add {type}</button>;\n};\n\nexport const SectionSaveButton = (props) => {\n    const { context = isRequired(\"section context\") } = props;\n    const { form = isRequired(\"form context\") } = props;\n    const { data = isRequired(\"section data\") } = props;\n\n    const handleSave = (e) => {\n        const shouldSave = data.text !== form.values.text;\n        console.log(\"Saving\", shouldSave);\n\n        if (!shouldSave) return context.setEdit(!context.isEdit);\n        if (!props.onSave) return;\n\n        props.onSave();\n    };\n\n    return (\n        <IconButton Icon={Icons.ArrowUpCircle} label=\"Save\" className=\"section-btn\" title=\"Save\" onClick={handleSave} />\n    );\n};\n\nexport const SectionDeleteButton = (props) => {\n    console.log(props);\n    const { context = isRequired(\"section context\") } = props;\n    const { data = isRequired(\"section data\") } = props;\n\n    return (\n        <IconButton\n            {...props}\n            Icon={Icons.Trash}\n            className=\"section-btn btn-danger\"\n            title=\"Delete\"\n            onClick={() => context.remove(data.slug)}\n        />\n    );\n};\n\nexport const SectionEditButton = (props) => {\n    const { context = isRequired(\"section context\") } = props;\n    const { isEdit } = context;\n\n    if (isEdit) return <SectionSaveButton {...props} />;\n\n    return (\n        <IconButton\n            Icon={isEdit ? Icons.Eye : Icons.PencilSquare}\n            className=\"section-btn\"\n            title={isEdit ? \"Preview Mode\" : \"Edit Mode\"}\n            onClick={() => context.setEdit(!isEdit)}\n        />\n    );\n};\n","import { getClassName } from \"@miq/utils\";\n\nexport const SectionBody = ({ children, id, className }) => (\n    <div id={id} className={getClassName([\"section-body\", className])}>\n        {children}\n    </div>\n);\n\nexport const SectionHeader = ({ children, Icon, id, className }) => (\n    <div id={id} className={getClassName([\"section-header\", className])}>\n        {Icon && (\n            <div className=\"\">\n                <Icon className=\"icon\" />\n            </div>\n        )}\n\n        {children}\n    </div>\n);\n\nexport const SectionFooter = ({ children, id, className }) => (\n    <div id={id} className={getClassName([\"section-footer\", className])}>\n        {children}\n    </div>\n);\n","import { getService } from \"@miq/utils\";\nimport { API } from \"../utils\";\n// import { PAGE_CREATE_PATH } from \"../editor\";\n\nconst initialState = { results: [], items: {} };\n\nconst actions = {};\n\nexport const pagesServices = {\n    path: \"pages/\",\n    list(params) {\n        return getService(API, this.path, params);\n    },\n    get(pageSlug, params) {\n        return getService(API, `${this.path}${pageSlug}/`, params);\n    },\n};\n\nexport const pagesActions = {\n    post(values) {\n        return actions.post(`${this.path}`, values, \"ADD_UPDATE_PAGE\");\n    },\n    patch(pageSlug, values, oldValues) {\n        return actions.patch(`${this.path}${pageSlug}/`, values, oldValues);\n    },\n    postSection(pageSlug, values) {\n        return actions.post(`${this.path}${pageSlug}/section/`, values, \"APPEND_SECTION\");\n    },\n    delete(pageSlug) {\n        return actions.delete(`${this.path}${pageSlug}/`, pageSlug, \"REMOVE_PAGE\");\n    },\n};\n\nexport const pagesReducer = (state = initialState, action) => {\n    const { type, payload = {} } = action;\n    let items;\n\n    switch (type) {\n        case \"SET_PAGES\":\n            const { results, ...rest } = payload;\n            state = { ...rest };\n\n            if (results) {\n                items = {};\n\n                results.forEach((item) => {\n                    items[`${item.slug}`] = item;\n                });\n                state = { ...state, items };\n            }\n            return state;\n\n        case \"ADD_UPDATE_PAGE\":\n            items = { ...state.items, [payload.slug]: payload };\n            return { ...state, items };\n\n        case \"REMOVE_PAGE\":\n            items = state.items;\n            delete items[payload.slug];\n            return { ...state, items };\n\n        default:\n            return { ...state };\n    }\n};\n"],"sourceRoot":""}